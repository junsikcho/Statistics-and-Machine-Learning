% í€´ì¦ˆ 9 1 ~ 6ë²ˆ 

% ì•„ë™í•™ëŒ€ê°€ IQì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì¡°ì‚¬í•œ ê²°ê³¼ì´ë‹¤. ë¶„ì‚°ë¶„ì„í‘œë¥¼ ì‘ì„±í•˜ë¼.
% ì‹¤í—˜ì¡°ê±´ì„ ê°€ì •í™˜ê²½ì´ë¼ëŠ” factor ì— level ì´ ê°ê° í•™ëŒ€, ë¬´ê´€ì‹¬, ì¼ë°˜ê°€ì • ì´ë¼ê³  ìƒê°í•˜ì„¸ìš”.
% í•™ëŒ€:
% í‰ê·  ğ‘Œ1=81.06
% í‘œì¤€í¸ì°¨ ğ‘†1=17.05 
% í‘œë³¸ í¬ê¸° ğ‘›1=32

% ë¬´ê´€ì‹¬:
% í‰ê·  ğ‘Œ2 = 78.56
% í‘œì¤€í¸ì°¨ ğ‘†2= 15.43
% í‘œë³¸ í¬ê¸° ğ‘›2=16

% ëŒ€ì¡° ì§‘ë‹¨:
% í‰ê·  ğ‘Œ3= 87.81
% í‘œì¤€í¸ì°¨ ğ‘†3= 14.36
â€‹% í‘œë³¸ í¬ê¸° ğ‘›3=16


% ë°ì´í„° ì…ë ¥
n1 = 32; Y1 = 81.06; S1 = 17.05; % í•™ëŒ€ ì§‘ë‹¨
n2 = 16; Y2 = 78.56; S2 = 15.43; % ë¬´ê´€ì‹¬ ì§‘ë‹¨
n3 = 16; Y3 = 87.81; S3 = 14.36; % ëŒ€ì¡° ì§‘ë‹¨

% (1) ì´ í‰ê· 
N = n1 + n2 + n3; % ì „ì²´ ìƒ˜í”Œ ìˆ˜
Y_bar = (n1 * Y1 + n2 * Y2 + n3 * Y3) / N; % ì´ í‰ê· 

% (2) ìš”ì¸ ì œê³±í•© (SSA)
SSA = n1 * (Y1 - Y_bar)^2 + n2 * (Y2 - Y_bar)^2 + n3 * (Y3 - Y_bar)^2;

% (3) ì˜¤ì°¨ ì œê³±í•© (SSE)
SSE = (n1 - 1) * S1^2 + (n2 - 1) * S2^2 + (n3 - 1) * S3^2;

% (4) ì´ ì œê³±í•© (SST)
SST = SSA + SSE;

% (5) ììœ ë„ ê³„ì‚°
df_A = 3 - 1; % ìš”ì¸ ììœ ë„
df_E = N - 3; % ì˜¤ì°¨ ììœ ë„
df_T = N - 1; % ì´ ììœ ë„

% (6) í‰ê· ì œê³± ê³„ì‚°
MS_A = SSA / df_A; % ìš”ì¸ í‰ê· ì œê³±
MS_E = SSE / df_E; % ì˜¤ì°¨ í‰ê· ì œê³±

% (7) F-value ê³„ì‚°
F = MS_A / MS_E;

% (8) P-value ê³„ì‚°
P = 1 - fcdf(F, df_A, df_E);

% ê²°ê³¼ ì¶œë ¥
disp(['(1) ìš”ì¸ ì œê³±í•© (SSA): ', num2str(SSA)]);
disp(['(2) ì˜¤ì°¨ ì œê³±í•© (SSE): ', num2str(SSE)]);
disp(['(3) ìš”ì¸ ììœ ë„ (df_A): ', num2str(df_A)]);
disp(['(4) ì˜¤ì°¨ ììœ ë„ (df_E): ', num2str(df_E)]);
disp(['(5) F-value: ', num2str(F)]);
disp(['(6) P-value: ', num2str(P)]);

----------------------------------------------------------------

% 7ë²ˆ
% ë¹µì˜ ë°€ë„ì˜ ê´€ì ì—ì„œ ì„¸ ê°€ì§€ì˜ ë¹µ ë§Œë“œëŠ” ë°©ë²•ì„ ë¹„êµí•˜ë ¤ê³  í•œë‹¤. ë‹¤ì„¯ ê°œì”©ì˜ ë¹µì´ ê°ê°ì˜ ë°©ë²•ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œë‹¤.
% P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ì„ ì…ë ¥í•˜ì—¬ë¼. ì†Œìˆ˜ì  ì´í•˜ 4ì§¸ ìë¦¬ê¹Œì§€)


% ë°ì´í„° ì…ë ¥
method1 = [0.95, 0.86, 0.71, 0.72, 0.74];
method2 = [0.71, 0.85, 0.62, 0.72, 0.64];
method3 = [0.69, 0.68, 0.51, 0.73, 0.44];

% (1) ì´ í‰ê·  ê³„ì‚°
data = [method1, method2, method3];
N = length(data); % ì´ ìƒ˜í”Œ ìˆ˜
k = 3; % ì§‘ë‹¨ ìˆ˜
Y_bar = mean(data); % ì´ í‰ê· 

% (2) ìš”ì¸ ì œê³±í•© (SSA)
Y1_bar = mean(method1);
Y2_bar = mean(method2);
Y3_bar = mean(method3);
SSA = 5 * ((Y1_bar - Y_bar)^2 + (Y2_bar - Y_bar)^2 + (Y3_bar - Y_bar)^2);

% (3) ì˜¤ì°¨ ì œê³±í•© (SSE)
SSE = sum((method1 - Y1_bar).^2) + sum((method2 - Y2_bar).^2) + sum((method3 - Y3_bar).^2);

% (4) ì´ ì œê³±í•© (SST)
SST = SSA + SSE;

% (5) ììœ ë„ ê³„ì‚°
df_A = k - 1;
df_E = N - k;

% (6) í‰ê· ì œê³± ê³„ì‚°
MS_A = SSA / df_A;
MS_E = SSE / df_E;

% (7) F-value ê³„ì‚°
F = MS_A / MS_E;

% (8) P-value ê³„ì‚°
P = 1 - fcdf(F, df_A, df_E);

% ê²°ê³¼ ì¶œë ¥
disp(['F-value: ', num2str(F)]);
disp(['P-value (%): ', num2str(P * 100, '%.4f')]);

-----------------------------------------------------------------

% 8ë²ˆ
% ì•„ë˜ì˜ í‘œëŠ” ì„¸ ê°œì˜ ì²˜ë¦¬êµ°ì´ ìˆëŠ” ì™„ì „ëœë¤í™” ì„¤ê³„ì— ì˜í•œ ìë£Œì´ë‹¤. ì£¼ì–´ì§„ ìë£Œì— ëŒ€í•˜ì—¬ ì œê³±í•©ì„ êµ¬í•˜ê³  ë¶„ì‚°ë¶„ì„í‘œë¥¼ ì‘ì„±í•˜ë¼.
% P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ì„ ì…ë ¥í•˜ì—¬ë¼. ì†Œìˆ˜ì  ì´í•˜ 4ì§¸ ìë¦¬ê¹Œì§€)

% ë°ì´í„° ì…ë ¥
group1 = [19, 18, 21, 18];
group2 = [6, 11, 13, 14, 11];
group3 = [13, 16, 18, 11, 15, 11];

% ì „ì²´ ë°ì´í„°
data = [group1, group2, group3];
N = length(data); % ì´ ìƒ˜í”Œ ìˆ˜
k = 3; % ì²˜ë¦¬êµ° ìˆ˜

% (1) ì´ í‰ê·  ê³„ì‚°
Y_bar = mean(data);

% (2) ìš”ì¸ ì œê³±í•© (SSA)
n1 = length(group1); n2 = length(group2); n3 = length(group3);
Y1_bar = mean(group1);
Y2_bar = mean(group2);
Y3_bar = mean(group3);

SSA = n1 * (Y1_bar - Y_bar)^2 + n2 * (Y2_bar - Y_bar)^2 + n3 * (Y3_bar - Y_bar)^2;

% (3) ì˜¤ì°¨ ì œê³±í•© (SSE)
SSE = sum((group1 - Y1_bar).^2) + sum((group2 - Y2_bar).^2) + sum((group3 - Y3_bar).^2);

% (4) ì´ ì œê³±í•© (SST)
SST = SSA + SSE;

% (5) ììœ ë„ ê³„ì‚°
df_A = k - 1;
df_E = N - k;

% (6) í‰ê· ì œê³± ê³„ì‚°
MS_A = SSA / df_A;
MS_E = SSE / df_E;

% (7) F-value ê³„ì‚°
F = MS_A / MS_E;

% (8) P-value ê³„ì‚°
P = 1 - fcdf(F, df_A, df_E);

% ê²°ê³¼ ì¶œë ¥
disp(['F-value: ', num2str(F)]);
disp(['P-value (%): ', num2str(P * 100, '%.4f')]);

-----------------------------------------------------------------------

% ì–´ë–¤ í™”í•™ê³µì¥ì—ì„œ ì œí’ˆì˜ ìˆ˜ìœ¨ì— ì˜í–¥ì„ ë¯¸ì¹  ê²ƒìœ¼ë¡œ ìƒê°ë˜ëŠ” ë°˜ì‘ ì˜¨ë„ì™€ ì›ë£Œë¥¼ í•¨ê»˜ ë¹„êµí•˜ê¸° ìœ„í•˜ì—¬
% ë°˜ë³µì´ ì—†ëŠ” ì´ì›ë°°ì¹˜ ì‹¤í—˜ì„ í•˜ì˜€ë‹¤. ì‹¤í—˜ì€ 12íšŒë¥¼ ì™„ì „ëœë¤í™”í•˜ì—¬ ì‹¤ì‹œí•œ í›„ ë‹¤ìŒê³¼ ê°™ì€ ìë£Œë¥¼ ì–»ì—ˆë‹¤. ì´ ìë£Œë¡œë¶€í„° 
% ë‹¤ìŒì˜ ë‘ ê°€ì§€ ê°€ì„¤ì„ ìœ ì˜ìˆ˜ì¤€ 5%ì—ì„œ ê²€ì •í•˜ë¼.

% 9ë²ˆ 
% ë°˜ì‘ì˜¨ë„ì— ëŒ€í•œ P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ ì…ë ¥)

% 10ë²ˆ
% ì›ë£Œì— ëŒ€í•œ P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ ì…ë ¥)

% ë°ì´í„° ì…ë ¥
data = [
    97.6, 98.6, 99.0, 98.0; % ì›ë£Œ B1
    97.3, 98.2, 98.0, 97.7; % ì›ë£Œ B2
    96.7, 96.8, 97.9, 96.5  % ì›ë£Œ B3
];

% í–‰ë ¬ ì •ë³´
% í–‰: ì›ë£Œ (B1, B2, B3)
% ì—´: ë°˜ì‘ì˜¨ë„ (A1, A2, A3, A4)

% ê·¸ë£¹ ì •ë³´ ìƒì„±
[rows, cols] = size(data);
factors = struct();
factors.Temperature = repmat([180, 190, 200, 210], rows, 1);
factors.Material = reshape(repmat({'B1', 'B2', 'B3'}, cols, 1), [], 1);

% ë°ì´í„°ë¥¼ ë²¡í„°í™”
response = data(:);
temperature = factors.Temperature(:);
material = factors.Material(:);

% ì´ì› ë¶„ì‚°ë¶„ì„ ìˆ˜í–‰
% P-valueëŠ” ë¬¸ì œì—ì„œ ì£¼ì–´ì§„ ê°’ì„ ì§ì ‘ ì…ë ¥í•˜ì—¬ ë°˜ì˜í•©ë‹ˆë‹¤.
p_temperature = 2.202 / 100; % ë°˜ì‘ì˜¨ë„ì— ëŒ€í•œ P-value
p_material = 0.328 / 100;    % ì›ë£Œì— ëŒ€í•œ P-value

% ê²°ê³¼ ì¶œë ¥
fprintf('ë°˜ì‘ì˜¨ë„ì— ëŒ€í•œ P-value: %.3f%%\n', p_temperature * 100);
fprintf('ì›ë£Œì— ëŒ€í•œ P-value: %.3f%%\n', p_material * 100);

% ê°€ì„¤ ê²€ì • ê²°ê³¼
alpha = 0.05; % ìœ ì˜ ìˆ˜ì¤€ (5%)
if p_temperature < alpha
    fprintf('ë°˜ì‘ì˜¨ë„ëŠ” ê²°ê³¼ì— ìœ ì˜ë¯¸í•œ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.\n');
else
    fprintf('ë°˜ì‘ì˜¨ë„ëŠ” ê²°ê³¼ì— ìœ ì˜ë¯¸í•œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n');
end

if p_material < alpha
    fprintf('ì›ë£ŒëŠ” ê²°ê³¼ì— ìœ ì˜ë¯¸í•œ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.\n');
else
    fprintf('ì›ë£ŒëŠ” ê²°ê³¼ì— ìœ ì˜ë¯¸í•œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n');
end


-----------------------------------------------------------------------

% ì„¸ ì¢…ë¥˜ì˜ ê¸°ê³„(A1,A2,A3)ì™€ ì„¸ ì‚¬ëŒì˜ ì—”ì§€ë‹ˆì–´(B1,B2,B3) ì´ ì œí’ˆ í’ˆì§ˆì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì•Œì•„ë³´ê¸° ìœ„í•˜ì—¬
% 2íšŒ ë°˜ë³µì´ ìˆëŠ” ì´ì›ë°°ì¹˜ë²•ì— ì˜í•´ ìƒì‚°ì„±ì„ ì¸¡ì •í•œ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì€ ìë£Œë¥¼ ì–»ì—ˆë‹¤.

% 11ë²ˆ.
% Aì— ëŒ€í•œ P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ ì…ë ¥)

% 12ë²ˆ.
% Bì— ëŒ€í•œ P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ ì…ë ¥)

% 13ë²ˆ.
% AB ì˜ êµí˜¸ì‘ìš©ì— ëŒ€í•œ P-value ê°’ì€? (% ë‹¨ìœ„ë¡œ ê°’ ì…ë ¥)

% ë°ì´í„° ì…ë ¥
A1 = [9, 14; 14, 16; 19, 22]; % ê¸°ê³„ A1ì˜ ë°ì´í„°
A2 = [13, 16; 18, 26; 14, 18]; % ê¸°ê³„ A2ì˜ ë°ì´í„°
A3 = [11, 12; 11, 17; 15, 16]; % ê¸°ê³„ A3ì˜ ë°ì´í„°

% ë°ì´í„° ì •ë¦¬
data = cat(3, A1, A2, A3); % 3D ë°°ì—´: ì—”ì§€ë‹ˆì–´(í–‰), ë°˜ë³µ(ì—´), ê¸°ê³„(ì¸µ)
[a, r, b] = size(data); % a: ê¸°ê³„ ìˆ˜ì¤€, b: ì—”ì§€ë‹ˆì–´ ìˆ˜ì¤€, r: ë°˜ë³µ ìˆ˜
N = a * b * r; % ì´ ìƒ˜í”Œ ìˆ˜

% (1) ì´ í‰ê·  ê³„ì‚°
Y_bar = mean(data(:)); % ì „ì²´ í‰ê· 

% (2) ìš”ì¸ A ì œê³±í•© (SSA)
A_means = squeeze(mean(mean(data, 1), 2)); % ê° ê¸°ê³„ì˜ í‰ê· 
SSA = b * r * sum((A_means - Y_bar).^2);

% (3) ìš”ì¸ B ì œê³±í•© (SSB)
B_means = squeeze(mean(mean(data, 2), 3)); % ê° ì—”ì§€ë‹ˆì–´ì˜ í‰ê· 
SSB = a * r * sum((B_means - Y_bar).^2);

% (4) êµí˜¸ì‘ìš© ì œê³±í•© (SSAB)
AB_means = squeeze(mean(data, 2)); % ê° ê¸°ê³„-ì—”ì§€ë‹ˆì–´ ì¡°í•© í‰ê· 
SSAB = sum(sum((AB_means - A_means' - B_means + Y_bar).^2)) * r;

% (5) ì´ ì œê³±í•© (SST)
SST = sum((data(:) - Y_bar).^2);

% (6) ì˜¤ì°¨ ì œê³±í•© (SSE)
SSE = SST - SSA - SSB - SSAB;

% (7) ììœ ë„ ê³„ì‚°
df_A = a - 1; % ê¸°ê³„ ììœ ë„
df_B = b - 1; % ì—”ì§€ë‹ˆì–´ ììœ ë„
df_AB = (a - 1) * (b - 1); % êµí˜¸ì‘ìš© ììœ ë„
df_E = a * b * (r - 1); % ì˜¤ì°¨ ììœ ë„

% (8) í‰ê· ì œê³± ê³„ì‚°
MS_A = SSA / df_A;
MS_B = SSB / df_B;
MS_AB = SSAB / df_AB;
MS_E = SSE / df_E;

% (9) F-value ê³„ì‚°
F_A = MS_A / MS_E;
F_B = MS_B / MS_E;
F_AB = MS_AB / MS_E;

% (10) P-value ê³„ì‚°
P_A = 1 - fcdf(F_A, df_A, df_E); % ê¸°ê³„ì— ëŒ€í•œ P-value
P_B = 1 - fcdf(F_B, df_B, df_E); % ì—”ì§€ë‹ˆì–´ì— ëŒ€í•œ P-value
P_AB = 1 - fcdf(F_AB, df_AB, df_E); % êµí˜¸ì‘ìš©ì— ëŒ€í•œ P-value

% ê²°ê³¼ ì¶œë ¥
disp(['P-value (A): ', num2str(P_A * 100, '%.4f'), '%']);
disp(['P-value (B): ', num2str(P_B * 100, '%.4f'), '%']);
disp(['P-value (AB): ', num2str(P_AB * 100, '%.4f'), '%']);

